{% extends 'base.html.twig' %}

{% block title %}
    Home - {{ parent() }}
{% endblock %}

{% block body %}
    {% if app.user %}
        <a href="{{ path('ticket_new') }}" class="btn btn-primary">
            Create a new ticket</a>
    {% endif %}
    <hr>
    {% if tickets_created is defined %}
        {% if tickets_created != null %}<h3>Tickets Created</h3>{% else %}<h3>No Tickets created</h3>{% endif %}
        {% for ticket in tickets_created %}
            <a href="{{ path('ticket_show', { 'id': ticket.id }) }}">
                <h2>{{ ticket.title }}</h2>
            </a>

            <p><span class="glyphicon glyphicon-time"></span> Posted on
                {% if ticket.created %}{{ ticket.created|date('Y-m-d H:i:s') }}{% endif %}
            </p>
            By {{ ticket.owner }}
            <p>Users granted : </p>

            {% for usersGranted in ticket.users %}
                {{ usersGranted.username }}
            {% endfor %}
            <hr>
        {% endfor %}
    {% endif %}

    {% if tickets_granted is defined %}
        {% if tickets_granted != null %}<h3>Tickets Granted</h3>{% else %}<h3>No Tickets granted</h3>{% endif %}
        {% for ticket in tickets_granted %}
            <a href="{{ path('ticket_show', { 'id': ticket.id }) }}">
                <h2>{{ ticket.title }}</h2>
            </a>

            <p><span class="glyphicon glyphicon-time"></span> Posted on
                {% if ticket.created %}{{ ticket.created|date('Y-m-d H:i:s') }}{% endif %}
            </p>
            By {{ ticket.owner }}
            <p>Users granted : </p>

            {% for usersGranted in ticket.users %}
                {{ usersGranted.username }}
            {% endfor %}
            <hr>
        {% endfor %}
    {% endif %}

    {% if tickets is defined %}
        <h3>All Tickets</h3>
        {% for ticket in tickets %}
            <a href="{{ path('ticket_show', { 'id': ticket.id }) }}">
                <h2>{{ ticket.title }}</h2>
            </a>

            <p><span class="glyphicon glyphicon-time"></span> Posted on
                {% if ticket.created %}{{ ticket.created|date('Y-m-d H:i:s') }}{% endif %}
            </p>
            By {{ ticket.owner }}
            <p>Users granted : </p>

            {% for usersGranted in ticket.users %}
                {{ usersGranted.username }}
            {% endfor %}
            <hr>
        {% endfor %}
    {% endif %}
{% endblock %}